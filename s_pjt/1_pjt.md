# API
## 서버와 클라이언트
- 서버
  - 부탁을 받으면 처리해주거나, 부탁대로 원하는 값을 돌려주는 역할
- 클라이언트
  - 부탁하는 역할
  <br>
  > 홈페이지에 접속하는 것도 서버와 클라이언트의 관계이다.<br>
  > 클라이언트가 홈페이지 주소를 입력하면 해당 페이지의 **서버에게 요청**을 하는 것<br>
  > 요청 받은 서버는 홈페이지의 메인 화면을 클라이언트에게 **제공**

### 클라이언트의 요청 방법
1. 웹 브라우저 주소창에 주소를 입력
   - 입력은 서버에 요청을 준비하는 단계
   - `Enter`를 치면 요청을 전달
   - 서버가 해당 주소에 정해놓은 데이터가 표출
   > **예시**
   > `https://fakestoreapi.com/carts`에서<br>
   > ~com 부분이 서버 주소<br>
   > 이후 부분은 데이터의 요청 주소

2. 서버에 정보를 요청하는 파이썬 코드 작성 
   - 파이썬에서 서버로 요청을 보낼 수 있는 패키지가 `requests`
   - 파이썬 패키지 관리 시스템이 `pip`

### 파이썬에서 요청
```python
import requests

response = requests.get(url).json()
```
- url
  - 요청을 보내는 서버의 주소
- `requests.get(url)`
  - 해당 서버 주소에 데이터 요청을 보내는 함수
- `.json()`
  - 내부의 데이터를 파이썬 딕셔너리와 유사한 JSON 형태로 변환해주는 함수

### 서버의 요청 해석 방법
#### API
클라이언트가 원하는 기능을 수행하기 위해 서버 측에 만들어 놓은 프로그램
- 서버 측에 특정 주소로 요청이 오면 정해진 기능을 수행하는 API를 미리 제작
- API는 클라이언트의 요청을 받아 해당하는 데이터를 서버 DB에서 검색
- API는 검색을 통해 조회된 데이터를 다시 클라이언트에게 전달

### JSON
API가 사용하는 데이터 형식
- 데이터를 저장하거나 전송할 때 많이 사용되는 <span style = "color:RED">경량 텍스트 기반 데이터 형식</span>
- 단순히 데이터를 표현하는 방법 중 하나
  #### 특징
  - 딕셔너리 자료형
  - 키-값 쌍의 집합으로 표현
  - 값은 `,`로 구분

  #### 관련 용어
  - 파싱(Parsing) : 데이터를 의미있는 구조로 분석하고 해석하는 과정
  - `json.loads()` : JSON 형식의 문자열을 파싱하여 딕셔너리로 변환

### OPEN API
외부에서 사용할 수 있도록 무료로 개방된 API
  #### 주의사항
  - 오픈 API는 허가받은 클라이언트만 사용 가능
  - 지나치게 많은 계정에서 동시에 요청을 보내면 서버 과부하
  - 허가 받은 클라이언트는 **API KEY**를 활용하여 확인
  - 허가 받은 KEY를 통해서도 과부하가 올 수 있으므로, **KEY별 사용량 제한**

## 금일 PJT 후기
- 기존에 API를 사용하려고 홈페이지 예시를 보면, 어디에 key를 넣고 어떻게 봐야 하는지 감이 잡히지 않았다.
- 그러나 파이썬의 requests 패키지를 이용하여, 쉽게 딕셔너리 형태로 데이터를 받아올 수 있음을 알았다.

### 오픈 API pjt에서 새로 배운 것
> 딕셔너리 형태로 데이터를 받아오기 때문에, 딕셔너리 관련 코드를 찾아보았다.<br>
> 이번 실습을 통해 잘 알게 된건 딕셔너리 Key를 변경하는 방법이었다.<br>
> value의 경우 아래의 형태로 여러번 변경한 경험이 있다.<br>
   ```python
   dict['key'] = new_value
   ```
> 그러나 key를, 특히 C 문제에서 여러개의 key를 변경했던 적은 없었다.<br>
> 오늘 다중 key를 바꾼 코드는 아래와 같다.
   ```python
   key_change = {'old_key1': 'new_key1', 'old_key2': 'new_key2', ...}

   old_dict = {'old_key1': 값1, 'old_key2': 값2, ...}
   # old_dict의 key를 위의 key_change의 value로 바꿔야 한다.

   # key_change는 오래된 키이름을 key로 새로운 키이름을 value로 갖는 딕셔너리다.

   for old, new in key_change.items():
       if old in old_dict.keys():
           old_dict[new] = old_dict.pop(old)
   # .pop()은 리스트에서는 맨 뒤의 요소나 특정 인덱스의 값을 반환한 후 제외하는 기능이다.
   # 그러나 딕셔너리에서는 .pop(key)를 사용하면 해당 key의 value를 반환하고, 기존의 {key: value}를 제외시킨다.
   ```

### 오픈 API사용 중의 애로사항
오픈 API는 분명 대량의 데이터를 받을 수 있는 유용한 도구이지만, 다루면서 어려운 점도 존재했다.
- 받은 데이터의 형태 파악
- 일부 유료 API

먼저 곤혹스러웠던 데이터 형태부터 말해보겠다.
<br></br>
1. 데이터의 형태 파악
이 부분에서 크게 두 가지의 문제가 있었다.
- 딕셔너리 key의 파악
  > 딕셔너리에 어떤 key가 있는지 그리고 그 key는 어떠한 의미인지를 파악해야 했다.<br>
  > 실제 데이터는 딕셔너리의 단계가 매우 깊었다.<br>
  > 딕셔너리 내의 딕셔너리, 딕셔너리 내의 딕셔너리가 있었다.
  > 그러므로 명세서나 사용자가 요구하는 정보를 찾기 위해서는 웬만한 키의 의미를 파악해야 했다.<br>
  > 다행이도 이번에는 value의 형까지 확인하지는 않아도 되었다는 점이다.
- 딕셔너리와 리스트의 혼용
  > 일부 딕셔너리 안의 딕셔너리는 리스트로 감싸여 있었다.<br>
  > 심지어 요소가 하나뿐인데도 대괄호로 둘러싸여 있었다.<br>
  > 리스트 내 여러 딕셔너리가 존재하는 경우도 있기에 양식을 통일하고 해당 리스트에서 원하는 딕셔너리를 인덱스로 빠르게 찾게 하기 위함이겠지만, 한 리스트에 한 딕셔너리 요소는 들어가는(탐색) 과정이 너무 번거로웠다.

2. 오픈 API 사이 유료 API
    > OpenWeatherMap API의 경우 현재 날씨나 5일간의 3시간 간격 예보 API의 경우 오픈 API이다.<br>
    > 그러나 같은 페이지의 향후 16일간 예보나, 내가 쓰려고 했던 과거 통계 자료는 돈을 지불하여야 했다.<br>
    > 향후 프로젝트에서 데이터가 필요할 때, 해당 데이터를 무료로 API key만 있으면 얻을 수 있는지 확인을 확실히 해야 할 듯 싶다.

### Chat-GPT 애로사항
기존에 배운 방식으로 페르소나를 만들어주고 질문을 던졌다. 그 결과는 GPT가 제공한 url은 공식 페이지의 것과 맞지 않았다. 원하는 답을 얻기 위해서는 내가 API 페이지에서 조사한 내용을 추가로 입력해주어야 했다.

### 느낀점
오늘은 오픈 API로 데이터를 파이썬을 이용해 받아와 약간의 가공을 하는 실습을 하였다. 코드 자체의 난이도 보다는 데이터 양의 방대함 때문에 애먹었다.<br>
추후 이 데이터를 이용해서 사용자들에게 금융 웹 서비스로 제공한다는 것이 기대된다. 데이터를 확인하고 전처리하고 저장하는 과정도 필요하다. 그리고 웹사이트의 형태도 만들어야 한다. 사용자가 원하는 정보를 찾을 수 있는 기능도 필요하다. 최종적으로 사용자와 사이트, 데이터가 서로 연결되도록 해야 한다. 적기만 해도 긴 과정인데, 열심히 배워서 만들어내면 좋겠다.
